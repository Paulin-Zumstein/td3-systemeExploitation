#include <stdio.h>
#include <stdlib.h>
#include <fcntl.h>
#include <unistd.h>
#include <stdbool.h>

void coder(char* fichier){
    int fe, l, r, fs;
    unsigned char car, pos=0; char nom[10];

    fe=open(fichier, O_RDONLY);

    l = read(fe, &car, 1);

    while(l>0){
        strcpy(nom, " "); 
        nom[0]=car; 
        strcat(nom, ".in");

        if((fs=open(nom, O_RDONLY))==-1){
        	fs=open(nom, O_CREAT|O_WRONLY, 0666);
        }
        else{
            close(fs); 
            fs=open(nom, O_APPEND|O_RDWR);
        }
        r=write(fs, &pos, 1);
        close(fs);

        pos++;
        l=read(fe, &car, l);

    }
    close(fe);
}


int main(){
	coder("legang.txt");
	/*int fd;
	fd = open("fichierTest.txt",O_RDWR);*/
	/*char c[] = "voiture";
	crypteChaine(c);
	printf("%s\n", c );*/

}

/*void crypteChaine(char c[]){
	int i =0;
	while (c[i]!='\0'){
		if (c[i]<'x'){
			char f =c[i];
			f += 3;
			c[i] = f;
		}else{
			c[i]=c[i]+3-26;
		}
		i++;
	}
}

void coder(char message[], int clef) {
	int i = 0;
	while (message[i] != '\0') {
		if (message[i] >= 'A' && message[i]<= 'Z') {
			char c = message[i] - 'A';
			c += clef;
			c = c % 26;
			message[i] = c + 'A';
		}else if (message[i] >= 'a' && message[i]<= 'z') {
			char c = message[i] - 'a';
			c += clef;
			c = c % 26;
			message[i] = c + 'a';

		}
		i++;
	}
	printf("%s\n", message);









bool appartien(char x, char *dejaVue){
	int i=0;
	while(dejaVue[i]!='\0'){
		if (dejaVue[i]==x){
			return true;
		}
	}
	return false;
}

void ajouterDejaVue(char carac){
	int descDejaVue;
	char *nom = strcat(carac,".in");
	descDejaVue=open(nom,O_WRONLY);
	lseek(descDejaVue,0,SEEK_END);
	write(descDejaVue,lu,1);
	close(descDejaVue);
}

void ajouterPasDejaVue(char carac, char *dejaVue){
	int desPasDejaVue;
	char *nom=strcat(carac,".in");
	descDejaVue=open(nom, O_WRONLY | O_CREAT | O_TRUNC, 0644);
	write(descPasDejaVue,lu,1);
	close(descPasDejaVue);
}

void crypterFichier(char *nom){
	int desc,l;
	char *dejaVue;
	char lu;
	desc=open(nom,0_RDONLY);
	l=read(desc,$lu,1);
	while(l>0){
		if(appartien(lu,dejaVue)){
			ajouterDejaVue($lu);
		}
		else{
			ajouterPasDejaVue(lu,dejaVue);
		}
	}
	close(desc);
}*/