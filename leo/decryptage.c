#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <string.h>



void decrypter(){


	char *nomFichier;
	int descList, descDecrypte, descNumber,l1,l2 = 0;
	char lu1,lu2;

	system("ls *.in >sortie.txt");

	descList = open("sortie.txt",O_RDONLY);
	if(descList<0){ exit(1);}
	descDecrypte = open("fichierDecrypte.txt",O_CREAT | O_WRONLY | O_TRUNC,0644);
	if(descDecrypte<0){ exit(1);}

	l1 = read(descList,&lu1,1);
	while(l1>0){
		nomFichier ="";
		while(lu1!="\n"){
			nomFichier = strcat(nomFichier,lu1);
		}
		descNumber = open(nomFichier,O_RDONLY);

		l2 = read(descNumber,&lu2,1);
		while(l2>0){	
			lseek(descDecrypte,lu2,SEEK_SET);
			write(descDecrypte,nomFichier,1);
			l2 = read(descNumber,&lu2,1);
		}
		close(nomFichier);
	}
	system("rm sortie.txt");

}

int main(){
	decrypter();
	//creer le fichier "sortie" qui repertorie tous les fichiers du cryptage
	//system("ls *.in>sortie.txt");
	//execlp("ls","ls","*.in",">sortie",NULL);
	//execlp("ls","ls >","sortie.txt",NULL);

	//parcours un fichier text dans son ensemble
	//recuperer le nombre de caractere
	//creer le fichier de destination 
}